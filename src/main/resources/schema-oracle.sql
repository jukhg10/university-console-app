-- Eliminar tablas si existen (en orden inverso a la creación para evitar errores de FK)
DROP TABLE INSCRIPCION;
DROP TABLE CURSOPROFESOR;
DROP TABLE CURSO;
DROP TABLE PROFESOR;
DROP TABLE ESTUDIANTE;
DROP TABLE PROGRAMA;
DROP TABLE FACULTAD;
DROP TABLE PERSONA;

-- --- TABLAS PRINCIPALES CON SINTAXIS DE ORACLE ---

CREATE TABLE PERSONA (
    ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NOMBRES VARCHAR2(255) NOT NULL,
    APELLIDOS VARCHAR2(255) NOT NULL,
    EMAIL VARCHAR2(255)
);

CREATE TABLE FACULTAD (
    ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NOMBRE VARCHAR2(255) NOT NULL,
    DECANO_ID NUMBER,
    CONSTRAINT FK_FACULTAD_DECANO FOREIGN KEY (DECANO_ID) REFERENCES PERSONA(ID)
);

CREATE TABLE PROGRAMA (
    ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NOMBRE VARCHAR2(255) NOT NULL,
    DURACION NUMBER,
    REGISTRO_CALIFICADO DATE,
    FACULTAD_ID NUMBER,
    CONSTRAINT FK_PROG_FACULTAD FOREIGN KEY (FACULTAD_ID) REFERENCES FACULTAD(ID)
);

CREATE TABLE ESTUDIANTE (
    ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NOMBRES VARCHAR2(255) NOT NULL,
    APELLIDOS VARCHAR2(255) NOT NULL,
    EMAIL VARCHAR2(255),
    CODIGO NUMBER
);

CREATE TABLE PROFESOR (
    ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NOMBRES VARCHAR2(255) NOT NULL,
    APELLIDOS VARCHAR2(255) NOT NULL,
    EMAIL VARCHAR2(255),
    TIPO_CONTRATO VARCHAR2(255)
);

CREATE TABLE CURSO (
    ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    NOMBRE VARCHAR2(255) NOT NULL,
    PROGRAMA_ID NUMBER,
    ACTIVO NUMBER(1),
    CONSTRAINT FK_CURSO_PROG FOREIGN KEY (PROGRAMA_ID) REFERENCES PROGRAMA(ID)
);

CREATE TABLE INSCRIPCION (
    ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    ANO NUMBER,
    SEMESTRE NUMBER,
    ESTUDIANTE_ID NUMBER,
    CURSO_ID NUMBER,
    CONSTRAINT FK_INSC_ESTUD FOREIGN KEY (ESTUDIANTE_ID) REFERENCES ESTUDIANTE(ID),
    CONSTRAINT FK_INSC_CURSO FOREIGN KEY (CURSO_ID) REFERENCES CURSO(ID)
);

CREATE TABLE CURSOPROFESOR (
    PROFESOR_ID NUMBER,
    CURSO_ID NUMBER,
    ANO INT,
    SEMESTRE INT,
    PRIMARY KEY (PROFESOR_ID, CURSO_ID, ANO, SEMESTRE),
    CONSTRAINT FK_CP_PROFESOR FOREIGN KEY (PROFESOR_ID) REFERENCES PROFESOR(ID),
    CONSTRAINT FK_CP_CURSO FOREIGN KEY (CURSO_ID) REFERENCES CURSO(ID)
);

-- --- DATOS DE EJEMPLO (SINTAXIS ORACLE CON INSERTS INDIVIDUALES) ---

INSERT INTO PERSONA (ID, NOMBRES, APELLIDOS, EMAIL) VALUES (1, 'Ricardo', 'Perez', 'ricardo.perez@university.com');
INSERT INTO PERSONA (ID, NOMBRES, APELLIDOS, EMAIL) VALUES (2, 'Ana', 'Lopez', 'ana.lopez@university.com');
INSERT INTO PERSONA (ID, NOMBRES, APELLIDOS, EMAIL) VALUES (3, 'Luis', 'Martinez', 'luis.martinez@external.com');

INSERT INTO FACULTAD (ID, NOMBRE, DECANO_ID) VALUES (1, 'Ingeniería', 1);
INSERT INTO FACULTAD (ID, NOMBRE, DECANO_ID) VALUES (2, 'Ciencias Sociales', NULL);

INSERT INTO PROGRAMA (ID, NOMBRE, DURACION, REGISTRO_CALIFICADO, FACULTAD_ID) VALUES (1, 'Ingeniería de Sistemas', 10, TO_DATE('2023-01-15', 'YYYY-MM-DD'), 1);
INSERT INTO PROGRAMA (ID, NOMBRE, DURACION, REGISTRO_CALIFICADO, FACULTAD_ID) VALUES (2, 'Comunicación Social', 8, TO_DATE('2022-05-20', 'YYYY-MM-DD'), 2);

INSERT INTO PROFESOR (ID, NOMBRES, APELLIDOS, EMAIL, TIPO_CONTRATO) VALUES (1, 'Carlos', 'Ramirez', 'carlos.r@university.com', 'Tiempo Completo');
INSERT INTO PROFESOR (ID, NOMBRES, APELLIDOS, EMAIL, TIPO_CONTRATO) VALUES (2, 'Marta', 'Jimenez', 'marta.j@university.com', 'Cátedra');

INSERT INTO ESTUDIANTE (ID, NOMBRES, APELLIDOS, EMAIL, CODIGO) VALUES (1, 'Juan', 'Gomez', 'juan.g@student.com', 20241001);
INSERT INTO ESTUDIANTE (ID, NOMBRES, APELLIDOS, EMAIL, CODIGO) VALUES (2, 'Maria', 'Rodriguez', 'maria.r@student.com', 20241002);

INSERT INTO CURSO (ID, NOMBRE, PROGRAMA_ID, ACTIVO) VALUES (1, 'Cálculo Diferencial', 1, 1);
INSERT INTO CURSO (ID, NOMBRE, PROGRAMA_ID, ACTIVO) VALUES (2, 'Programación Orientada a Objetos', 1, 1);
INSERT INTO CURSO (ID, NOMBRE, PROGRAMA_ID, ACTIVO) VALUES (3, 'Teorías de la Comunicación', 2, 0);

INSERT INTO CURSOPROFESOR (PROFESOR_ID, CURSO_ID, ANO, SEMESTRE) VALUES (1, 1, 2025, 1);
INSERT INTO CURSOPROFESOR (PROFESOR_ID, CURSO_ID, ANO, SEMESTRE) VALUES (2, 2, 2025, 1);

INSERT INTO INSCRIPCION (ID, ESTUDIANTE_ID, CURSO_ID, ANO, SEMESTRE) VALUES (1, 1, 1, 2025, 1);
INSERT INTO INSCRIPCION (ID, ESTUDIANTE_ID, CURSO_ID, ANO, SEMESTRE) VALUES (2, 2, 2, 2025, 1);